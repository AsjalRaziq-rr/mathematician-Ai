<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mathematical Genius AI</title>
    <!-- Preload the font -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Noto+Sans+Math&display=swap" as="style">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+Math&display=swap">
    <style>
        /* Ensure font is loaded */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Math&display=swap');

        /* Rest of your styles remain the same */
        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }

        /* Previous styles remain unchanged... */

        /* Updated symbol button styles */
        .symbol-btn {
            font-family: 'Noto Sans Math', monospace !important;
            background: white;
            border: 1px solid #ddd;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 20px; /* Increased font size */
            transition: all 0.2s;
            min-width: 40px; /* Increased min-width */
            height: 40px; /* Increased height */
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            line-height: 1;
            font-weight: normal;
            text-rendering: optimizeLegibility;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Add fallback symbols using a different Unicode range */
        .symbol-btn[data-symbol="±"]::before { content: "\00B1"; }
        .symbol-btn[data-symbol="×"]::before { content: "\00D7"; }
        .symbol-btn[data-symbol="÷"]::before { content: "\00F7"; }
        .symbol-btn[data-symbol="≠"]::before { content: "\2260"; }
        .symbol-btn[data-symbol="≈"]::before { content: "\2248"; }
        .symbol-btn[data-symbol="≤"]::before { content: "\2264"; }
        .symbol-btn[data-symbol="≥"]::before { content: "\2265"; }
        .symbol-btn[data-symbol="α"]::before { content: "\03B1"; }
        .symbol-btn[data-symbol="β"]::before { content: "\03B2"; }
        .symbol-btn[data-symbol="γ"]::before { content: "\03B3"; }
        .symbol-btn[data-symbol="π"]::before { content: "\03C0"; }
        .symbol-btn[data-symbol="θ"]::before { content: "\03B8"; }
        .symbol-btn[data-symbol="∑"]::before { content: "\2211"; }
        .symbol-btn[data-symbol="∫"]::before { content: "\222B"; }
        .symbol-btn[data-symbol="∂"]::before { content: "\2202"; }
        .symbol-btn[data-symbol="√"]::before { content: "\221A"; }
        .symbol-btn[data-symbol="∞"]::before { content: "\221E"; }
        .symbol-btn[data-symbol="∈"]::before { content: "\2208"; }
        .symbol-btn[data-symbol="∉"]::before { content: "\2209"; }
        .symbol-btn[data-symbol="⊂"]::before { content: "\2282"; }
        .symbol-btn[data-symbol="∪"]::before { content: "\222A"; }
        .symbol-btn[data-symbol="∩"]::before { content: "\2229"; }

        .symbol-btn::before {
            font-family: 'Noto Sans Math', monospace !important;
        }

        /* Rest of your styles remain the same */
    </style>
</head>
<body>
    <div class="container">
        <!-- Previous header content remains the same -->
        <div class="input-section">
            <div class="image-upload">
                <!-- Image upload section remains the same -->
            </div>

            <div class="math-symbols-toolbar">
                <button class="scroll-btn scroll-left" onclick="scrollSymbols('left')">←</button>
                <div class="symbols-scroll" id="symbolsScroll">
                    <button class="symbol-btn" data-symbol="±" onclick="insertSymbol('±')"></button>
                    <button class="symbol-btn" data-symbol="×" onclick="insertSymbol('×')"></button>
                    <button class="symbol-btn" data-symbol="÷" onclick="insertSymbol('÷')"></button>
                    <button class="symbol-btn" data-symbol="≠" onclick="insertSymbol('≠')"></button>
                    <button class="symbol-btn" data-symbol="≈" onclick="insertSymbol('≈')"></button>
                    <button class="symbol-btn" data-symbol="≤" onclick="insertSymbol('≤')"></button>
                    <button class="symbol-btn" data-symbol="≥" onclick="insertSymbol('≥')"></button>
                    <button class="symbol-btn" data-symbol="α" onclick="insertSymbol('α')"></button>
                    <button class="symbol-btn" data-symbol="β" onclick="insertSymbol('β')"></button>
                    <button class="symbol-btn" data-symbol="γ" onclick="insertSymbol('γ')"></button>
                    <button class="symbol-btn" data-symbol="π" onclick="insertSymbol('π')"></button>
                    <button class="symbol-btn" data-symbol="θ" onclick="insertSymbol('θ')"></button>
                    <button class="symbol-btn" data-symbol="∑" onclick="insertSymbol('∑')"></button>
                    <button class="symbol-btn" data-symbol="∫" onclick="insertSymbol('∫')"></button>
                    <button class="symbol-btn" data-symbol="∂" onclick="insertSymbol('∂')"></button>
                    <button class="symbol-btn" data-symbol="√" onclick="insertSymbol('√')"></button>
                    <button class="symbol-btn" data-symbol="∞" onclick="insertSymbol('∞')"></button>
                    <button class="symbol-btn" data-symbol="∈" onclick="insertSymbol('∈')"></button>
                    <button class="symbol-btn" data-symbol="∉" onclick="insertSymbol('∉')"></button>
                    <button class="symbol-btn" data-symbol="⊂" onclick="insertSymbol('⊂')"></button>
                    <button class="symbol-btn" data-symbol="∪" onclick="insertSymbol('∪')"></button>
                    <button class="symbol-btn" data-symbol="∩" onclick="insertSymbol('∩')"></button>
                </div>
                <button class="scroll-btn scroll-right" onclick="scrollSymbols('right')">→</button>
            </div>

            <textarea id="question" placeholder="Enter your mathematical question here..."></textarea>
            <button onclick="askQuestion()">Get Solution</button>
        </div>

        <div id="loading" class="loading">
            Calculating solution...
        </div>

        <div class="response-section" id="response">
            Your solution will appear here...
        </div>

        <div class="example-questions">
            <h3>Try these example questions:</h3>
            <div class="example-question" onclick="useExample(this)">What is the derivative of x^3 + 2x^2 - 4x + 1?</div>
            <div class="example-question" onclick="useExample(this)">Solve the quadratic equation: 2x^2 + 5x - 12 = 0</div>
            <div class="example-question" onclick="useExample(this)">Calculate the area of a circle with radius 7 units</div>
        </div>
    </div>
    <script type="module">
        import { askMathematician } from './index.js';

        // Ensure font is loaded before displaying symbols
        document.fonts.ready.then(() => {
            document.body.style.visibility = 'visible';
        });

        let currentImage = null;

        window.handleImageUpload = function(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('imagePreview');
                    const previewImg = document.getElementById('previewImg');
                    const removeBtn = document.getElementById('removeImage');
                    
                    previewImg.src = e.target.result;
                    preview.style.display = 'block';
                    removeBtn.style.display = 'inline-block';
                    currentImage = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        };

        window.removeImage = function() {
            const preview = document.getElementById('imagePreview');
            const previewImg = document.getElementById('previewImg');
            const removeBtn = document.getElementById('removeImage');
            const imageInput = document.getElementById('imageInput');
            
            preview.style.display = 'none';
            previewImg.src = '';
            removeBtn.style.display = 'none';
            imageInput.value = '';
            currentImage = null;
        };

        window.insertSymbol = function(symbol) {
            const textarea = document.getElementById('question');
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            const text = textarea.value;
            const before = text.substring(0, start);
            const after = text.substring(end);
            
            textarea.value = before + symbol + after;
            textarea.focus();
            textarea.selectionStart = textarea.selectionEnd = start + symbol.length;
        };

        window.scrollSymbols = function(direction) {
            const container = document.getElementById('symbolsScroll');
            const scrollAmount = 100;
            if (direction === 'left') {
                container.scrollLeft -= scrollAmount;
            } else {
                container.scrollLeft += scrollAmount;
            }
        };

        window.askQuestion = async function() {
            const questionInput = document.getElementById('question');
            const responseDiv = document.getElementById('response');
            const loadingDiv = document.getElementById('loading');
            
            if (!questionInput.value.trim() && !currentImage) {
                alert('Please enter a question or upload an image');
                return;
            }

            loadingDiv.style.display = 'block';
            responseDiv.textContent = '';

            try {
                const answer = await askMathematician(questionInput.value, currentImage);
                responseDiv.innerHTML = answer.replace(/\n/g, '<br>');
            } catch (error) {
                responseDiv.textContent = 'Error: ' + error.message;
            } finally {
                loadingDiv.style.display = 'none';
            }
        }

        window.useExample = function(element) {
            document.getElementById('question').value = element.textContent;
        }
    </script>
</body>
</html>
